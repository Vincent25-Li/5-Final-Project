{% extends 'tripblog/base.html' %}

{% block css %}
{% load static %}
<link href="https://fonts.googleapis.com/css?family=Quicksand:400,500,700" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
<link rel="stylesheet" href={% static "tripblog/css/froala_editor.css" %}>
<link rel="stylesheet" href={% static "tripblog/css/froala_style.css" %}>
<link rel="stylesheet" href={% static "tripblog/css/plugins/code_view.css" %}>
<link rel="stylesheet" href={% static "tripblog/css/plugins/image_manager.css" %}>
<link rel="stylesheet" href={% static "tripblog/css/plugins/image.css" %}>
<link rel="stylesheet" href={% static "tripblog/css/plugins/table.css" %}>
<link rel="stylesheet" href={% static "tripblog/css/plugins/video.css" %}>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.3.0/codemirror.min.css">
<link rel="stylesheet" href={% static "tripblog/css/edit_article2.css" %}>
{% endblock %}


{% block content %}
<form method="post">
	<div class="flex-parent">
		<img src="{% static "tripblog/images/plus.png" %}" alt="addnewday" class="imgdayplus" />
		<div class="titleinput-flex-container">
			<a>旅程標題</a> <input type="text"style="width: 400px;"> <br>
			<a>旅程期間</a> <input type="text" style="width: 100px;"> to <input type="text" style="width: 100px;"> <a>交通方式</a> <input type="text">	
		</div>
		<div class="input-flex-container inputline" id="addinput1">
		
			<div class="input active">
				<span data-info="1日"></span>
			</div>
		</div>
		<div class="description-flex-container" id="addinput2">
			<p class="active">
				<a>時間</a><input type="text"> <a>景點</a><input type="text">
				<img src="{% static "tripblog/images/plus.png" %}" alt="addnewinput" class="imginputplus canclick" /><br>
			</p>
		</div>
	</div>
	<div class="flex-child">
		<div class="child-flex-content" id="addinput3">
			<div id="editor">
				<input type="submit" value="儲存行程">
				<textarea id='edit' style="margin-top: 30px;" placeholder="從這裡開始寫"></textarea>
			</div>
		</div>
	</div>
</form>
{% endblock %}

{% block script %}
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.3.0/codemirror.min.js"></script>
<script type="text/javascript"
	src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.3.0/mode/xml/xml.min.js"></script>
<script type="text/javascript" src={% static "tripblog/js/froala_editor.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/align.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/code_beautifier.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/code_view.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/draggable.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/image.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/image_manager.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/link.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/lists.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/paragraph_format.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/paragraph_style.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/table.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/video.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/url.min.js" %}></script>
<script type="text/javascript" src={% static "tripblog/js/plugins/entities.min.js" %}></script>
<script>
	(function () {
		const editorInstance = new FroalaEditor('#edit', {
			enter: FroalaEditor.ENTER_P,
			placeholderText: null,
			events: {
				initialized: function () {
					const editor = this
					this.el.closest('form').addEventListener('submit', function (e) {
						console.log(editor.$oel.val())
						e.preventDefault()
					})
				}
			}
		})
	})()
</script>
<script>
	$(function () {
		$($('.input')).click(function () {
			var t = $(this),
				ind = t.index(),
				matchedPara = $($('.description-flex-container').find('p')).eq(ind);

			$(t).add(matchedPara).addClass('active');
			$($('.input')).not(t).add($($('.description-flex-container').find('p')).not(matchedPara)).removeClass('active');
		});
	});

	$("img.imginputplus").click(function () {
		var addtextinput = $("<a>時間</a><input type='text'> <a>景點</a><input type='text'><br>");
		$("p.active").append(addtextinput);
		$("img.imginputplus").addClass("canclick")
	});
	a = 1
	$(".imgdayplus").click(function () {
		a = a + 1;
		var addtextinput = $("<div class='input'><span data-info='" + a + "日'></span></div>");
		$("#addinput1").append(addtextinput);
		var addtextinput = $("<p><a>時間</a><input type='text'> <a>景點</a><input type='text'> <img src='{% static "tripblog/images/plus.png" %}' alt='addnewinput' class='imginputplus'/><br></p>");
		$("#addinput2").append(addtextinput);
		$("img[class='imginputplus'][class!='imginputplus canclick']").click(function () {
			var addtextinput = $("<a>時間</a><input type='text'> <a>景點</a><input type='text'><br>");
			$("p.active").append(addtextinput);
		});		
		$("img[class='imginputplus']").addClass("canclick")
		var addtextinput = $("<textarea id='edit' style='margin-top: 30px;' placeholder='從這裡開始寫'></textarea>");
		$("#editor").append(addtextinput);
		$($('.input')).click(function () {
			var t = $(this),
				ind = t.index(),
				matchedPara = $($('.description-flex-container').find('p')).eq(ind);
			$(t).add(matchedPara).addClass('active');
			$($('.input')).not(t).add($($('.description-flex-container').find('p')).not(matchedPara)).removeClass('active');
		});

		

		const editorInstance = new FroalaEditor('#edit', {
			enter: FroalaEditor.ENTER_P,
			placeholderText: null,
			events: {
				initialized: function () {
					const editor = this
					this.el.closest('form').addEventListener('submit', function (e) {
						console.log(editor.$oel.val())
						e.preventDefault()
					})
				}
			}
		})
	});
</script>
{% endblock %}